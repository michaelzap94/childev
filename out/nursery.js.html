<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: nursery.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: nursery.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// imported packages
var mongoose = require('mongoose');
var bcrypt   = require('bcrypt-nodejs');
var passportLocalMongoose = require("passport-local-mongoose");

// nursaryDetails Schema ---------------------------------------------------


/**
 * This Object defines the schema of the user's details.
 * @namespace
 * @property {string}  name - The name of the nursery.
 * @property {string}  urn - The URN of the nursery.
 * @property {Integer} nurserycontactnumber - The contact number of the nursery.
 * @property {object}  address - The address of the nursery.
 * @property {string}  address.address1 - The first line of the address of the nursery.
 * @property {string}  address.address2 - The second line of the address of the nursery.
 * @property {string}  address.city - The city of the address of the nursery.
 * @property {string}  address.country - The country of the address of the nursery.
 * @property {string}  address.postcode - The postcode of the nursery.
 * @property {string}  firstname - The firstname of the nursery's manager.
 * @property {string}  lastname - The lastname of the nursery's manager
 * @property {Integer} managercontactnumber - The contact number of the manager.
 * @property {string}  managerlabel - A label with value 'manager'.
 */
 
var NurseryDetailsSchema = new mongoose.Schema({
    name:String,
    urn:String,
    nurserycontactnumber:Number,
    address: {
        address1:String,
        address2:String,
        city:String,
        country:String,
        postcode:String
    },
        firstname:String,
        lastname:String,
        managercontactnumber:Number,
        managerlabel: String
    
    
});
mongoose.model("NurseryDetails", NurseryDetailsSchema);
//----------------------------------------------------------------



/**
 * This Object defines the nursery Schema
 * @namespace
 * @property {string}  username - The nursery's email.
 * @property {string}  password - The nursery's password.
 * @property {string}  label - A label with value 'nursery'.
 * @property {Integer} active - A label to indicate if nursery has confirmed its email and hence, registerd successfully. Value is 1 (active) or 0 (inactive).
 * @property {string}  activationhash - A hash code used to register other users to this nursery.
 * @property {Integer} resetPasswordToken - A token that can be used to register the password of the nursery's account.
 * @property {object}  dateCreated - The date the account was created.
 * @property {object}  details - The 'NurseryDetailsSchema' schema object.
 * @property {object}  teacher -  The 'Teacher' schema object.
 * @property {object}  parent -  The 'Parent' schema object.
 * @property {object}  children -  The 'Children' schema object.
 * @property {array}  waitingRegistrationTeachers - An array that contains a list of teachers waiting for registration.
 * @property {array}  waitingRegistrationParents - An array that contains a list of parents waiting for registration.
 */

var nurserySchema = new mongoose.Schema({
    username:String,
    password:String,
    label:String,
    active:Number,
    activationhash:String,
    resetPasswordToken: Number,
    dateCreated:{type:Date, default: Date.now},// if date is empty the default is Date.now
    details: [NurseryDetailsSchema],
    teacher: [{
            type: mongoose.Schema.Types.ObjectId,
            ref: "Teacher"
    }],
    parent: [{
            type: mongoose.Schema.Types.ObjectId,
            ref: "Parent"
    }],
    children: [{
            type: mongoose.Schema.Types.ObjectId,
            ref: "Children"
    }],
    waitingRegistrationTeachers: [{type: String}],
    waitingRegistrationParents: [{email:String,childId:String}]

    
});



/**
 * This function hashes the password.
 * @param {string} password - the password to be checked.
 */
nurserySchema.methods.generateHash = function(password) {
    return bcrypt.hashSync(password, bcrypt.genSaltSync(8), null);
};

/**
 * Checks if password is valid
 * @param {string} password - the password to be checked.
 */
nurserySchema.methods.validPassword = function(password) {
    return bcrypt.compareSync(password, this.local.password);
};
/////////////////////////////////////////IMPORTANT
nurserySchema.plugin(passportLocalMongoose);
///////////////////////////////////////////////////////
// 
/**
* Creates the Nursery Schema to be saved in the database.
* @module app/schemas/admin/nursery
*/
module.exports = mongoose.model('Nursery', nurserySchema);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-app_schemas_admin_nursery.html">app/schemas/admin/nursery</a></li></ul><h3>Namespaces</h3><ul><li><a href="NurseryDetailsSchema.html">NurseryDetailsSchema</a></li><li><a href="nurserySchema.html">nurserySchema</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Mon Nov 28 2016 01:31:52 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
